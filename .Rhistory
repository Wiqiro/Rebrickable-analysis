inner_join(lego$colors, by = c("color_id" = "id")) %>%
dplyr::filter(color_id == most_used_colors$name) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name.x, rgb, year) %>%
count %>%
arrange(desc(year))
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors_year <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
dplyr::filter(color_id == most_used_colors$name) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name.x, rgb, year) %>%
count %>%
arrange(desc(year))
lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
dplyr::filter(color_id %in% most_used_colors$name) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name.x, rgb, year) %>%
count %>%
arrange(desc(year))
most_used_colors
lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
dplyr::filter(rgb %in% most_used_colors$rgb) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name.x, rgb, year) %>%
count %>%
arrange(desc(year))
lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
dplyr::filter(rgb %in% most_used_colors$rgb) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name.x, rgb, year) %>%
count %>%
arrange(desc(year)) %>% print(n=20)
most_used_colors
lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
dplyr::filter(rgb == most_used_colors$rgb) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name.x, rgb, year) %>%
count %>%
arrange(desc(year)) %>% print(n=20)
most_used_colors_year
most_used_colors
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(color_id, name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(id="no_id", name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(color_id="no_id", name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(color_id, name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(color_id=-Inf, name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors
most_used_colors %>%
select(id) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id"))
most_used_colors %>%
select(id)
most_used_colors %>%
select(color_id) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id"))
most_used_colors %>%
select(color_id) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name.x, rgb, year) %>%
count
most_used_colors %>%
select(color_id) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name, rgb, year) %>%
count
most_used_colors %>%
select(color_id, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name, rgb, year) %>%
count
most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(desc(year)) %>% print(n=20)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.8), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(desc(year)) %>% print(n=20)
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(desc(year))
esquisse:::esquisser()
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.8), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
esquisse:::esquisser()
ggplot(most_used_colors_year) +
aes(x = year, y = n, fill = rgb) +
geom_area() +
scale_fill_hue(direction = 1) +
theme_minimal()
ggplot(most_used_colors_year) +
aes(x = year, y = n, fill = rgb) +
geom_area() +
scale_fill_hue(direction = 1) +
ggplot(most_used_colors_year) +
aes(x = year, y = n, fill = rgb) +
geom_area() +
scale_fill_hue(direction = 1)
most_used_colors_year <- most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = rgb) +
geom_area() +
scale_fill_hue(direction = 1) +
theme_minimal()
most_used_colors_year <- most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = rgb) +
geom_area() +
scale_fill_manual(values=most_used_colors_year$rgb) +
theme_minimal()
most_used_colors_year
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(desc(year))
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = rgb) +
geom_area() +
scale_fill_manual(values=most_used_colors_year$rgb) +
theme_minimal()
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = rgb) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(desc(year)) %>%
dplyr::filter(year < 2023)
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year
most_used_colors_year %>%
filter(name=="Light Gray")
most_used_colors_year %>%
arrange(rgb) %>%
ggplot() +
aes(x = year, y = n, fill = rgb) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(desc(year)) %>%
dplyr::filter(year < 1980 & year < 2023)
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
theme_minimal()
most_used_colors_year %>%
arrange(name) %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(desc(name)) %>%
dplyr::filter(year < 1980 & year < 2023)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors_year$rgb, sep = "")) +
theme_minimal()
most_used_colors_year
most_used_colors
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
theme_minimal()
most_used_colors_year
distinct(most_used_colors_year$rgb)
most_used_colors_year$rgb
most_used_colors_year$rgb %>% unique
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(desc(name)) %>%
dplyr::filter(year < 1980 & year < 2023)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name) %>%
dplyr::filter(year < 1980 & year < 2023)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name) %>%
dplyr::filter(year < 2023)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name) %>%
dplyr::filter(year < 2023)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name) %>%
dplyr::filter(year < 1980)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name) %>%
dplyr::filter(year < 1990)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name) %>%
dplyr::filter(year < 2000)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name) %>%
dplyr::filter(year < 2010)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name) %>%
dplyr::filter(year < 2010 & year > 2000)
most_used_colors_year %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
most_used_colors_year %>%
dplyr::filter(year < 2023)
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name)
most_used_colors_year %>%
dplyr::filter(year < 2023)
most_used_colors_year <- most_used_colors %>%
select(color_id, name, rgb) %>%
inner_join(lego$inventory_parts, by = c("color_id"="color_id")) %>%
inner_join(lego$inventories, by = c("inventory_id"="id")) %>%
inner_join(lego$sets, by = c("set_num"="set_num")) %>%
group_by(name=name.x, rgb, year) %>%
count %>%
arrange(name)
most_used_colors_year %>%
dplyr::filter(year < 2023) %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_area() +
scale_fill_manual(values=paste("#", unique(most_used_colors_year$rgb), sep = "")) +
theme_minimal()
install.packages("tidyverse")
install.packages("DT")
