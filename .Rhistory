inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name=name.y, year, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="DDDDDD", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="DDDDDD", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ungroup %>%
group_by(year) %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="DDDDDD", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
lego$sets %>%
inner_join(lego$inventories, by = c("set_num" = "set_num")) %>%
inner_join(lego$inventory_parts, by = c("id" = "inventory_id")) %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name=name.y, year, rgb) %>%
count %>%
arrange(desc(n)) %>% group_by(name)
most_used_colors <- lego$sets %>%
inner_join(lego$inventories, by = c("set_num" = "set_num")) %>%
inner_join(lego$inventory_parts, by = c("id" = "inventory_id")) %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name=name.y, year, rgb) %>%
count %>%
arrange(desc(n)) %>% group_by(name)
most_used_colors$rgb <- paste("#", most_used_colors$rgb, sep = "")
most_used_colors %>%
ggplot() +
aes(x = year, y = n, fill = name) +
geom_bar(stat="identity", width=1) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
esquisse:::esquisser()
#Sets
lego$sets %>%
inner_join(lego$inventories, by=c("set_num"="set_num")) %>%
inner_join(lego$inventory_parts, by=c("id" = "inventory_id")) %>%
group_by(set_num, name) %>%
distinct(color_id) %>%
count %>%
arrange(desc(n))
#Most used colors in total
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="DDDDDD", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors$rgb <- paste("#", most_used_colors$rgb, sep = "")
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5), size = 20) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5), size = 1) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5), size = 5) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
esquisse:::esquisser()
esquisse:::esquisser()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=1), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_minimal()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n)), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=10), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=2), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.5), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.5), position = position_stack(vjust=0.5)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.7), position = position_stack(vjust=0.5)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
, position = position_stack(vjust=0.5)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5)) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.7), position = position_stack(vjust=0.5), size = 4) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.7), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5), size = 3) +
geom_text(aes(label = name, x=1.6), position = position_stack(vjust=0.3), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5), size = 3) +
geom_text(aes(label = name, x=1.6, y=2), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5), size = 3) +
geom_text(aes(label = name, x=1.6, y12), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5), size = 3) +
geom_text(aes(label = name, x=1.6, y=1), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = as.character(n), x=1.6), position = position_stack(vjust=0.5), size = 3) +
geom_text(aes(label = name, x=1.6), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_cat(name, as.character(n)), x=1.6), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
library(stringr)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_cat(name, as.character(n)), x=1.6), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, as.character(n)), x=1.6), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.6), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.7), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.7), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
guides(fill=FALSE) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.75), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
guides(fill=FALSE) +
theme_void()
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.75), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "") +
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.75), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=most_used_colors$rgb) +
guides(fill=FALSE) +
theme_void()
#Most used colors in total
most_used_colors <- lego$inventory_parts %>%
#Most used colors in total
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="DDDDDD", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.75), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
#Most used colors in total
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.75), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.75), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
```{r}
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.75), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.75), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.9), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
most_used_colors <- lego$inventory_parts %>%
inner_join(lego$colors, by = c("color_id" = "id")) %>%
group_by(name, rgb) %>%
count %>%
arrange(desc(n))
most_used_colors <- most_used_colors %>%
ungroup %>%
slice_head(n=10) %>%
add_row(name="Other", rgb="EEEEEE", n=sum(most_used_colors$n)-sum(.$n)) %>%
arrange(name)
most_used_colors %>%
ggplot() +
aes(x = "", y = n, fill = name) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0) +
geom_text(aes(label = str_c(name, '\n', as.character(n)), x=1.8), position = position_stack(vjust=0.5), size = 3) +
scale_fill_manual(values=paste("#", most_used_colors$rgb, sep = "")) +
guides(fill=FALSE) +
theme_void()
